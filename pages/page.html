<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{{pagename}}</title>
    <link rel="stylesheet" href="/styles.css" />
</head>

<body class="table-page">
    <div class="container wide">
        <!-- Top Bar -->
        <div class="top-bar">
            <h1 class="page-heading" style="margin-bottom: 20px; text-align: left;">{{pagename}}</h1>
            <p id="pageInvalidMessage" class="error-message"
                style="display: none; text-align: center; font-weight: bold; width: 100%; margin: 0;">
                This page is invalid.
            </p>
        </div>

        <!-- Links Table -->
        <table>
            <!-- <tr>
                <th>Link</th>
                <th>Description</th>
            </tr> -->
            <tbody>
                {{links}}
            </tbody>
        </table>
    </div>

    <div class="container wide" id="formContainer">
        <form action="/add" method="POST">
            <input type="hidden" id="page" name="page" value="{{pagename}}" />

            <label>Link <span id="linkError" class="error-message"></span></label>
            <div class="input-wrapper">
                <input type="text" id="link" name="link" maxlength="1000" required />
            </div>

            <label>Description</label>
            <input type="text" id="description" name="description" maxlength="1000" />

            <button type="submit">Store</button>
        </form>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", () => {
            // Read `allowAppending` from server-side rendering
            const allowAppending = "{{allowAppending}}" === "true";
            const formContainer = document.getElementById("formContainer");
            const pageInvalidMessage = document.getElementById("pageInvalidMessage");

            if (!allowAppending) {
                formContainer.style.pointerEvents = "none";
                formContainer.style.opacity = 0.75;
                pageInvalidMessage.style.display = "inline-block"; // Show warning message
            }
        });
    </script>

    <script src="/form-handler.js"></script>

</body>

</html>